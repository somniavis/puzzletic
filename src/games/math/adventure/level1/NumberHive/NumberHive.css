.number-hive-container {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    /* Removed custom background to use Layout1 default */
    position: relative;
    overflow: hidden;
}

/* Removed Header Styles - Now Handling by Layout3.css */

/* Honeycomb Grid */
.hive-grid-area {
    flex: 1;
    width: min(100%, 600px);
    max-width: 600px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    padding: 1rem;
    container-type: size;
    /* Enable container query units */
    overflow: hidden;
}

/* Honeycomb Layout - Row Based */
/* Honeycomb Layout - Row Based */
.honeycomb-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    /* Fill the container completely */
    width: min(100%, 600px);
    height: 100%;
    /* Remove pixel caps to allow full scaling */
    max-width: 600px;
    max-height: none;
}

/* Variable Defaults (Fallback for older Safari without container query units) */
.honeycomb-container {
    /* 
       Fallback sizing (no cqi/cqb support):
       keep it simple/robust for older Safari.
    */
    --hex-gap: clamp(4px, 1.1vmin, 9px);
    --hex-w: clamp(40px, 14.5vmin, 104px);
    --hex-h: calc(var(--hex-w) * 1.1547);
    --row-stagger: calc((var(--hex-w) + var(--hex-gap)) / 2);
}

/* 4x4 Adjustment */
.honeycomb-container.grid-4 {
    --hex-w: clamp(32px, 12vmin, 80px);
    --hex-h: calc(var(--hex-w) * 1.1547);
}

/* Use container query units when supported (newer browsers) */
@supports (width: 1cqi) {
    .honeycomb-container {
        /* 
           3x3 Grid Geometry: Width ~ 3.5 Hexes, Height ~ 2.9 Hexes 
           Width Constraint: 95% / 3.5 = ~27cqi
           Height Constraint: 95% / 2.9 = ~32cqb
        */
        --hex-w: min(27cqi, 32cqb);
        --hex-gap: 1.5cqmin;
    }

    .honeycomb-container.grid-4 {
        /* 
           4x4 Grid Geometry: Width ~ 4.5 Hexes, Height ~ 3.7 Hexes
           Width Constraint: 95% / 4.5 = ~21cqi
           Height Constraint: 95% / 3.7 = ~25cqb
        */
        --hex-w: min(21cqi, 25cqb);
    }
}

.hex-row {
    display: flex;
    justify-content: center;
    /* 
       Vertical Stacking Math for Pointy-Topped Hex:
       Distance between row centers = 0.75 * Height + Vertical_Gap
       Element Height = Height
       Margin needed = Distance - Height = -0.25 * Height + Vertical_Gap
    */
    margin-top: calc(var(--hex-h) * -0.25 + var(--hex-gap));
    pointer-events: none;
}

/* First row reset */
.hex-row:first-child {
    margin-top: 0;
}

/* 
   Horizontal Stagger Math:
   To center the zigzag block:
   Row A starts at X.
   Row B needs to be shifted by 0.5 * (Width + Gap).
   To center them relative to the container's vertical centerline:
   Row A: Shift Left by 0.25 * (Width + Gap)
   Row B: Shift Right by 0.25 * (Width + Gap)
   Difference = 0.5 * ... -> Perfect zigzag.
*/

/* Even rows shifted right */
.hex-row:nth-child(even) {
    transform: translateX(calc(var(--row-stagger) * 0.5));
}

/* Odd rows shifted left */
.hex-row:nth-child(odd) {
    transform: translateX(calc(var(--row-stagger) * -0.5));
}

.hex-cell {
    position: relative;
    width: var(--hex-w);
    height: var(--hex-h);
    /* Hexagon Aspect Ratio */
    margin: 0 calc(var(--hex-gap) / 2);

    /* Spotted Honey Effect */
    background-color: #fcd34d;
    background-image:
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.5) 0%, transparent 20%),
        radial-gradient(circle at 75% 65%, rgba(217, 119, 6, 0.3) 0%, transparent 40%),
        radial-gradient(circle at 40% 80%, rgba(217, 119, 6, 0.15) 0%, transparent 30%);

    box-shadow: inset 0 0 8px rgba(180, 83, 9, 0.3);

    display: flex;
    align-items: center;
    justify-content: center;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);

    cursor: pointer;
    font-size: calc(var(--hex-w) * 0.5);
    font-weight: 800;
    color: #78350f;
    user-select: none;

    pointer-events: auto;
    /* Re-enable clicks */

    transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), background-color 0.2s;
    /* Clean fuzzy edges */
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    -webkit-tap-highlight-color: transparent;
}

@media (hover: hover) {
    .hex-cell:hover {
        transform: scale(1.05);
        background-color: #fbbf24;
        background-image:
            radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.6) 0%, transparent 20%),
            radial-gradient(circle at 75% 65%, rgba(180, 83, 9, 0.3) 0%, transparent 40%);
        z-index: 10;
    }
}

.hex-cell:active {
    transform: scale(0.95);
}

.hex-cell.revealed {
    /* Spotted Blue Jelly */
    background-color: #3b82f6;
    background-image:
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.4) 0%, transparent 20%),
        radial-gradient(circle at 75% 65%, rgba(30, 58, 138, 0.3) 0%, transparent 40%);
    box-shadow: inset 0 0 8px rgba(30, 58, 138, 0.3);
    color: white;
    cursor: default;
    pointer-events: none;
    animation: pop-in 0.3s ease-out;
}

.hex-cell.shaking {
    /* Spotted Red Jam */
    animation: shake-hex 0.4s cubic-bezier(.36, .07, .19, .97) both;
    background-color: #ef4444;
    background-image:
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.4) 0%, transparent 20%),
        radial-gradient(circle at 75% 65%, rgba(153, 27, 27, 0.3) 0%, transparent 40%);
    color: white;
}

@keyframes shake-hex {

    10%,
    90% {
        transform: translate3d(-1px, 0, 0);
    }

    20%,
    80% {
        transform: translate3d(2px, 0, 0);
    }

    30%,
    50%,
    70% {
        transform: translate3d(-4px, 0, 0);
    }

    40%,
    60% {
        transform: translate3d(4px, 0, 0);
    }
}

@keyframes pop-in {
    0% {
        transform: scale(0);
        opacity: 0;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Background Decor */
.bee-deco {
    position: absolute;
    font-size: 3rem;
    opacity: 0.1;
    pointer-events: none;
    animation: float 5s ease-in-out infinite;
    /* Ensure z-index is low so it doesn't block clicks (pointer-events: none handles click, but visual layering) */
    z-index: 0;
}

.bee-inner {
    display: block;
    width: 100%;
    height: 100%;
}

.bee-flipped {
    transform: scaleX(-1);
}
