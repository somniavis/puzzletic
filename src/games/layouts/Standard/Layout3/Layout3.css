/* Layout3.css - Based on Layout1 but optimized for PowerUp Games */

.layout3-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100dvh;
    display: flex;
    flex-direction: column;
    background: linear-gradient(135deg, #e9d5ff 0%, #b1b2fb 50%, #fecdd3 100%);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    overflow: hidden;
    user-select: none;
    -webkit-user-select: none;
}

/* Custom Scrollbar */
.custom-scrollbar::-webkit-scrollbar {
    width: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
}

.custom-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 3px;
}

/* Header (Back/BGM) */
.layout3-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 60;
}

.header-title {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    font-weight: 700;
    color: #334155;
    font-size: 1.125rem;
    pointer-events: none;
}

.icon-btn {
    background: rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(4px);
    border: none;
    border-radius: 12px;
    padding: 0.75rem;
    min-width: 44px;
    min-height: 44px;
    cursor: pointer;
    transition: background 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    touch-action: manipulation;
    outline: none;
}

.icon-btn:hover {
    background: rgba(255, 255, 255, 0.5);
}

.icon-btn:focus,
.icon-btn:focus-visible,
.icon-btn:active {
    outline: none;
    box-shadow: none;
}

/* Dashboard (Score, Lives, etc) - Identical to Layout1 */
.layout3-dashboard {
    max-width: 37.5rem;
    margin: 4.5rem auto 1rem;
    padding: 0 1rem;
    z-index: 10;
}

.stats-grid-row {
    display: grid;
    grid-template-columns: 1.6fr 1fr 1fr 1fr;
    gap: 0.5rem;
}

.stat-card {
    background: rgba(255, 255, 255, 0.4);
    backdrop-filter: blur(8px);
    border-radius: 0.75rem;
    padding: 0.5rem;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    transition: flex 0.2s;
}

.stat-label {
    font-size: 0.75rem;
    color: #475569;
    margin-bottom: 0.25rem;
    height: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.layout3-dashboard .stat-value {
    font-size: 1.125rem;
    font-weight: 700;
    color: #1e293b;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    height: 1.75rem;
}

/* Game Area - Wrapper for Game Content */
.layout3-game-area {
    margin: 0 1rem 1rem;
    max-width: 37.5rem;
    /* 600px */
    flex: 1;
    background: #f5f3ff;
    /* Soft Violet White */
    border-radius: 1.25rem;
    border: 4px solid #a5b4fc;
    /* Soft Indigo */
    box-shadow: 0 6px 0 #6366f1, 0 10px 15px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    position: relative;
    align-self: center;
    width: 100%;
    min-width: 0;
    width: 100%;
    min-width: 0;
    overflow: hidden;
}

/* Old Android tap/focus highlight suppression for interactive game elements */
.layout3-game-area button,
.layout3-game-area [role="button"],
.layout3-game-area [tabindex] {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    touch-action: manipulation;
}

.layout3-game-area button:focus,
.layout3-game-area [role="button"]:focus,
.layout3-game-area [tabindex]:focus,
.layout3-game-area button:focus-visible,
.layout3-game-area [role="button"]:focus-visible,
.layout3-game-area [tabindex]:focus-visible {
    outline: none;
    box-shadow: none;
}

.layout-card-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    /* Behind content */
    pointer-events: none;
}

/* Layout3 Specific Sub-Header (PowerUps + Target) */
.layout3-sub-header {
    width: 100%;
    padding: 1rem 1rem 0 1rem;
    /* Top/Side padding, NO bottom padding for centering grid */
    display: flex;
    flex-direction: column;
    z-index: 10;
}

.powerup-row {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 0.7rem;
    justify-content: flex-start;
    width: 100%;
}

/* Target Display Card - Styles extracted from NumberHive */
.target-display-card {
    background-color: white;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    padding: 1rem 0.85rem;
    border-radius: 0.75rem;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.8rem;
    /* No margin-bottom */
    margin: 0 auto;
}

.target-emoji {
    font-size: 2.6rem;
    line-height: 1;
    color: #1e3a8a;
}

.target-display-card.with-label {
    justify-content: space-between;
}

.target-count {
    font-weight: 700;
    color: #0f172a;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.22rem;
    line-height: 1;
}

.target-token-number {
    font-size: 2.5rem;
    line-height: 1;
}

.target-token-operator {
    font-size: 2rem;
    line-height: 1;
}

.target-pill {
    font-size: 0.82rem;
    font-weight: 700;
    color: #1d4ed8;
    letter-spacing: 0.02em;
    background: #dbeafe;
    border-radius: 999px;
    padding: 0.4rem 0.85rem;
    white-space: nowrap;
    line-height: 1.1;
}

/* Content Wrapper for Game Board */
.layout3-grid-wrapper {
    flex: 1;
    width: 100%;
    display: flex;
    align-items: center;
    /* Vertical Center */
    justify-content: center;
    /* Horizontal Center */
    /* Enable CQ units for children */
}

/* Modals / Start Screen (Shared) */
.overlay-screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.9);
    z-index: 50;
    text-align: center;
    padding: 0;
}

/* ... (Start/Game Over styles same as Layout1, omitted here if assuming shared class usage, but copying key parts is safer for isolation) ... */
/* Simplified for this file, assuming most are utility or shared, but for safety I'll include key Layout1 structural classes but renamed to layout2 if needed, 
   but screens often share logic. I'll re-include the critical Overlay/Button styles. */

/* New Start Screen Layout */
.start-screen-layout {
    display: flex;
    flex-direction: column;
    height: 100%;
    background: transparent;
    backdrop-filter: none;
}

.start-header-section {
    flex-shrink: 0;
    padding: 5rem 2rem 0.7rem;
    text-align: center;
}

.game-title {
    font-size: 2rem;
    font-weight: 800;
    color: #1e293b;
    margin-bottom: 0.5rem;
}

.game-subtitle {
    font-size: 1.25rem;
    color: #475569;
    font-weight: 600;
    margin: 0;
}

.start-content-scroll {
    flex-grow: 1;
    overflow-y: auto;
    padding: 0 1.5rem;
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
}

.how-to-play-box {
    background: white;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    margin-bottom: 1rem;
    text-align: left;
}

.section-title {
    font-size: 1.125rem;
    font-weight: 700;
    color: #334155;
    margin: 0 0 1.5rem 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.section-title::before {
    content: 'ðŸ“–';
}

.game-description-text {
    color: #64748b;
    margin-bottom: 1.5rem;
    line-height: 1.5;
}

.instructions-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.instruction-item {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    padding: 1rem;
    background: #f8fafc;
    border-radius: 1rem;
    border: 2px solid #e2e8f0;
    border-bottom: 5px solid #cbd5e1;
    transition: transform 0.1s;
}

.instruction-item:active {
    transform: translateY(2px);
    border-bottom-width: 3px;
}

.instruction-icon {
    font-size: 1.5rem;
    line-height: 1;
}

.instruction-text strong {
    display: block;
    color: #1e293b;
    margin-bottom: 0.25rem;
    font-size: 0.95rem;
}

.instruction-text p {
    color: #64748b;
    font-size: 0.875rem;
    margin: 0;
}

.start-footer-section {
    flex-shrink: 0;
    padding: 1.5rem;
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
    display: flex;
    justify-content: center;
}

.start-btn,
.restart-btn {
    background: linear-gradient(180deg, #4ade80 0%, #3b82f6 100%);
    color: white;
    font-weight: 800;
    padding: 1rem 2rem;
    border-radius: 1rem;
    border: 3px solid #1d4ed8;
    box-shadow: 0 4px 0 #1e40af, 0 6px 12px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    font-size: 1.5rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 1rem;
    width: 100%;
    justify-content: center;
    height: 4.5rem;
}

/* Floating Particles */
@keyframes particleFloatUp {
    0% {
        transform: translateY(0px) rotate(0deg);
        opacity: 1;
    }

    100% {
        transform: translateY(-100px) rotate(360deg);
        opacity: 0;
    }
}

.particle {
    position: absolute;
    pointer-events: none;
    font-size: 1.6rem;
    z-index: 9999;
}
